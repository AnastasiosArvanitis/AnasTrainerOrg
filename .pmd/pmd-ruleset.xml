<?xml version="1.0" encoding="UTF-8"?>
<ruleset name="Salesforce Apex Ruleset"
         xmlns="http://pmd.sourceforge.net/ruleset/2.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.sourceforge.io/ruleset_2_0_0.xsd">

    <description>
        PMD ruleset for Salesforce Apex - All categories except performance
    </description>

    <!-- Security Rules -->
    <rule ref="category/apex/security.xml/ApexCRUDViolation">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexInsecureEndpoint">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexOpenRedirect">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexSOQLInjection">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexXSSFromURLParam">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/security.xml/ApexXSSFromEscapeFalse">
        <priority>1</priority>
    </rule>

    <!-- Best Practices Rules -->
    <rule ref="category/apex/bestpractices.xml/ApexUnitTestClassShouldHaveAsserts">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/ApexUnitTestShouldNotUseSeeAllDataTrue">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/AvoidLogicInTrigger">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/UnusedLocalVariable">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/ApexAssertionsShouldIncludeMessage">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/AvoidGlobalModifier">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/bestpractices.xml/DebugsShouldUseLoggingLevel">
        <priority>2</priority>
    </rule>

    <!-- Error Prone Rules -->
    <rule ref="category/apex/errorprone.xml/EmptyCatchBlock">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/EmptyIfStmt">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/EmptyWhileStmt">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/EmptyTryOrFinallyBlock">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/EmptyStatementBlock">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/AvoidNonExistentAnnotations">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/MethodWithSameNameAsEnclosingClass">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/errorprone.xml/OverrideBothEqualsAndHashcode">
        <priority>2</priority>
    </rule>

    <!-- Documentation Rules -->
    <rule ref="category/apex/documentation.xml/ApexDoc">
        <priority>1</priority>
    </rule>

    <!-- Design Rules -->
    <rule ref="category/apex/design.xml/ExcessiveClassLength">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/design.xml/ExcessiveParameterList">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/design.xml/ExcessivePublicCount">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/design.xml/NcssMethodCount">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/design.xml/NcssTypeCount">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/design.xml/StdCyclomaticComplexity">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/design.xml/CognitiveComplexity">
        <priority>1</priority>
    </rule>

    <rule ref="category/apex/design.xml/UnusedMethod">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/design.xml/AvoidDeeplyNestedIfStmts">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/design.xml/CyclomaticComplexity">
        <priority>2</priority>
    </rule>

    <!-- Code Style Rules -->
    <rule ref="category/apex/codestyle.xml/ClassNamingConventions">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/FieldNamingConventions">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/FormalParameterNamingConventions">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/LocalVariableNamingConventions">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/MethodNamingConventions">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/PropertyNamingConventions">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/IfStmtsMustUseBraces">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/WhileLoopsMustUseBraces">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/IfElseStmtsMustUseBraces">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/ForLoopsMustUseBraces">
        <priority>2</priority>
    </rule>

    <rule ref="category/apex/codestyle.xml/OneDeclarationPerLine">
        <priority>2</priority>
    </rule>

</ruleset>
